<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ï¼”ã‘ãŸãƒ©ãƒ³ãƒ€ãƒ æ•°å­—ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</title>
<style>
  :root{
    --bg:#0b1220; --fg:#e8f0ff; --muted:#9fb0d0; --accent:#7dd3fc; --card:#111a2b;
    --btn:#1b2540; --btn2:#0f172a; --ok:#22c55e; --warn:#f59e0b; --danger:#ef4444;
  }
  *{box-sizing:border-box}
  body{margin:0; font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Hiragino Kaku Gothic ProN","Noto Sans JP","Yu Gothic",sans-serif; background:linear-gradient(180deg,#0a1222 0%,#060a16 100%); color:var(--fg)}
  .wrap{max-width:1200px; margin:24px auto; padding:0 16px}
  header{display:flex; align-items:center; gap:10px; margin-bottom:16px}
  header h1{font-size:22px; font-weight:700; margin:0}

  .grid{display:grid; grid-template-columns:1fr 360px; gap:18px}
  @media (max-width:980px){.grid{grid-template-columns:1fr}}

  .panel{background:var(--card); border:1px solid #1d2742; border-radius:16px; padding:18px; box-shadow:0 8px 30px rgba(0,0,0,.35)}

  .display{height:300px; display:flex; align-items:center; justify-content:center; border-radius:16px; background:radial-gradient(1200px 300px at 50% 0%, rgba(45,212,191,.06), transparent 60%); border:1px solid #1b2746}
  .digits{font-variant-numeric:tabular-nums; letter-spacing:.12em; font-weight:800; text-shadow:0 0 20px rgba(125,211,252,.25), 0 0 60px rgba(125,211,252,.12);}
  .digits.visible{color:#cde7ff; font-size:96px}
  /* å®Œå…¨ã«è¦‹ãˆãªã„ã‚ˆã†ã«ï¼ˆå½±ãƒ»ã¼ã‹ã—ã‚‚ç„¡åŠ¹åŒ–ï¼‰ */
  .digits.hidden{color:transparent; font-size:96px; text-shadow:none; filter:none; visibility:hidden}

  .row{display:flex; flex-wrap:wrap; gap:10px; margin-top:14px}
  button, .btn{appearance:none; border:none; color:var(--fg); background:var(--btn); padding:10px 16px; border-radius:12px; cursor:pointer; font-weight:700; box-shadow:inset 0 0 0 1px #263256}
  button:hover{background:#22305a}
  .primary{background:#0ea5e9; color:#031225; box-shadow:none}
  .primary:hover{background:#38bdf8}
  .ghost{background:transparent; box-shadow:inset 0 0 0 1px #2a355a}
  .ok{background:#16a34a}
  .warn{background:#d97706}
  .danger{background:#ef4444}
  .muted{color:var(--muted)}
  .pill{display:inline-flex; align-items:center; gap:.5em; padding:6px 10px; border-radius:999px; background:#0e1a32; font-size:12px}

  .section h2{margin:0 0 10px 0; font-size:16px; color:#cde7ff}
  .side .section{padding:14px 12px; border:1px solid #192445; border-radius:12px; margin-bottom:12px; background:#0c152a}
  .opt{display:flex; align-items:center; gap:10px; margin:8px 0}
  .opt input[type="radio"], .opt input[type="checkbox"]{transform:scale(1.1)}
  .num{width:68px; padding:8px 10px; border-radius:10px; border:1px solid #29345a; background:#0b1328; color:#e8f0ff; font-weight:700}
  .kbd{font-family:ui-monospace,SFMono-Regular,Menlo,monospace; font-size:12px; background:#0a1326; border:1px solid #1a2548; padding:2px 6px; border-radius:6px}
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>ï¼”ã‘ãŸãƒ©ãƒ³ãƒ€ãƒ æ•°å­—ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼</h1>
      <span class="pill">Space â–¶ æ¬¡ã®æ•°ï½œH è¡¨ç¤º/éè¡¨ç¤ºï½œF å…¨ç”»é¢ï½œR ãƒªã‚»ãƒƒãƒˆ</span>
    </header>

    <div class="grid">
      <!-- LEFT: main area -->
      <div class="panel">
        <div class="display">
          <div id="digits" class="digits visible" aria-live="polite">0000</div>
        </div>

        <div class="row">
          <button id="nextBtn" class="primary">â–¶ æ¬¡ã®æ•°</button>
          <button id="speakBtn">ğŸ”Š èª­ã¿ä¸Šã’</button>
          <button id="toggleBtn" class="ghost">ğŸ‘ è¡¨ç¤ºãƒ»éè¡¨ç¤º</button>
          <button id="resetBtn" class="ghost">â†º ãƒªã‚»ãƒƒãƒˆ</button>
        </div>
        <div class="row muted" style="font-size:12px">
          â€» ï¼’ã‘ãŸãƒ»ï¼“ã‘ãŸãƒ»ï¼”ã‘ãŸã‹ã‚‰é¸ã¹ã¾ã™ã€‚å¿…è¦ã«å¿œã˜ã¦è¨­å®šã‚’å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚
        </div>
      </div>

      <!-- RIGHT: options -->
      <aside class="panel side">
        <div class="section">
          <h2>æ¡æ•°</h2>
          <label class="opt"><input type="radio" name="digits" value="2"> ï¼’ã‘ãŸï¼ˆ10ã€œ99ï¼‰</label>
          <label class="opt"><input type="radio" name="digits" value="3"> ï¼“ã‘ãŸï¼ˆ100ã€œ999ï¼‰</label>
          <label class="opt"><input type="radio" name="digits" value="4" checked> ï¼”ã‘ãŸï¼ˆ1000ã€œ9999ï¼‰</label>
        </div>

        <div class="section">
          <h2>ã‚¼ãƒ­ã®ä½ç½®æ¡ä»¶</h2>
          <label class="opt"><input type="checkbox" id="zeroRule" checked> ä¸€ï¼åï¼ç™¾ã®ã„ãšã‚Œã‹ã« ï¼ ã‚’å«ã‚€</label>
          <p class="muted" style="font-size:12px; line-height:1.5">
            â€» ï¼’ã‘ãŸã§ã¯ã€Œä¸€ã®ä½ã®ã¿ï¼å¯ï¼ˆ10,20,...ï¼‰ã€ã€ï¼“ã‘ãŸã§ã¯ã€Œä¸€ãƒ»åã®ã©ã¡ã‚‰ã‹ã«ï¼ã€ã€ï¼”ã‘ãŸã§ã¯ã€Œä¸€ãƒ»åãƒ»ç™¾ã®ã„ãšã‚Œã‹ã«ï¼ã€ã€‚å…ˆé ­ï¼ˆåãƒ»ç™¾ãƒ»åƒï¼‰ã®ï¼ã¯ä½œã‚Šã¾ã›ã‚“ã€‚
          </p>
        </div>

        <div class="section">
          <h2>é€£ç¶šãƒ¢ãƒ¼ãƒ‰</h2>
          <div class="opt">é–“éš”ï¼ˆç§’ï¼‰ï¼š<input id="intervalSec" class="num" type="number" min="1" value="2"></div>
          <div class="row">
            <button id="autoStart" class="ghost">â–¶ è‡ªå‹•ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
            <button id="autoStop" class="ghost">â¹ åœæ­¢</button>
          </div>
          <label class="opt"><input type="checkbox" id="autoSpeak"> è‡ªå‹•ã§èª­ã¿ä¸Šã’ã‚‹</label>
        </div>

        <div class="section">
          <h2>ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ</h2>
          <div class="muted" style="font-size:12px; line-height:1.7">
            <span class="kbd">Space</span>ï¼šæ¬¡ã®æ•°ã€€ï½œã€€<span class="kbd">H</span>ï¼šè¡¨ç¤º/éè¡¨ç¤ºã€€ï½œã€€<span class="kbd">F</span>ï¼šå…¨ç”»é¢ã€€ï½œã€€<span class="kbd">R</span>ï¼šãƒªã‚»ãƒƒãƒˆ
          </div>
        </div>
      </aside>
    </div>
  </div>

<script>
(() => {
  const digitsEl = document.getElementById('digits');
  const nextBtn = document.getElementById('nextBtn');
  const speakBtn = document.getElementById('speakBtn');
  const toggleBtn = document.getElementById('toggleBtn');
  const resetBtn = document.getElementById('resetBtn');
  const zeroRule = document.getElementById('zeroRule');
  const autoStart = document.getElementById('autoStart');
  const autoStop = document.getElementById('autoStop');
  const autoSpeak = document.getElementById('autoSpeak');
  const intervalSec = document.getElementById('intervalSec');

  let currentDigits = 4;
  let currentNumber = 0;
  let hidden = false; // è¡¨ç¤ºãƒ»éè¡¨ç¤ºçŠ¶æ…‹ã¯ä¿æŒ
  let timer = null;

  // æ¡ãƒ©ã‚¸ã‚ª
  document.querySelectorAll('input[name="digits"]').forEach(r => {
    r.addEventListener('change', () => {
      currentDigits = Number(r.value);
      showNew();
    });
  });

  // ä¹±æ•°ç”Ÿæˆï¼ˆã‚¼ãƒ­ä½ç½®æ¡ä»¶ã‚’è€ƒæ…®ï¼‰
  function randNDigits(d){
    const min = 10**(d-1);
    const max = 10**d - 1;

    function ok(n){
      if(!zeroRule.checked) return true;
      const s = String(n).padStart(d,'0');
      const start = 1; // å…ˆé ­æ¡ã®æ¬¡ã‹ã‚‰
      const end = d-1; // æœ€ä¸‹ä½ã¾ã§
      for(let i=start;i<=end;i++) if(s[i]==='0') return true;
      return false;
    }

    let n;
    do{
      n = Math.floor(Math.random()*(max-min+1))+min;
    } while(!ok(n));
    return n;
  }

  // èª­ã¿ï¼ˆã‹ãªï¼‰ã‚’ä½œã‚‹
  function numberToReading(n){
    const ones = ['','ã„ã¡','ã«','ã•ã‚“','ã‚ˆã‚“','ã”','ã‚ã','ãªãª','ã¯ã¡','ãã‚…ã†'];
    const tens = ['','ã˜ã‚…ãƒ¼','ã«ã˜ã‚…ãƒ¼','ã•ã‚“ã˜ã‚…ãƒ¼','ã‚ˆã‚“ã˜ã‚…ãƒ¼','ã”ã˜ã‚…ãƒ¼','ã‚ãã˜ã‚…ãƒ¼','ãªãªã˜ã‚…ãƒ¼','ã¯ã¡ã˜ã‚…ãƒ¼','ãã‚…ã†ã˜ã‚…ãƒ¼'];
    const hundreds = ['','ã²ã‚ƒã','ã«ã²ã‚ƒã','ã•ã‚“ã³ã‚ƒã','ã‚ˆã‚“ã²ã‚ƒã','ã”ã²ã‚ƒã','ã‚ã£ã´ã‚ƒã','ãªãªã²ã‚ƒã','ã¯ã£ã´ã‚ƒã','ãã‚…ã†ã²ã‚ƒã'];
    const thousands = ['','ã›ã‚“','ã«ã›ã‚“','ã•ã‚“ãœã‚“','ã‚ˆã‚“ã›ã‚“','ã”ã›ã‚“','ã‚ãã›ã‚“','ãªãªã›ã‚“','ã¯ã£ã›ã‚“','ãã‚…ã†ã›ã‚“'];

    const s = String(n).padStart(4,'0');
    const a = s.split('').map(x => Number(x));
    const th = thousands[a[0]];
    const hu = hundreds[a[1]];
    const te = tens[a[2]];
    const on = ones[a[3]];

    const parts = [];
    if(th) parts.push(th);
    if(hu) parts.push(hu);
    if(te) parts.push(te);
    if(on) parts.push(on);
    if(parts.length===0) parts.push('ãœã‚');
    return parts.join(' ');
  }

  // TTS ç”¨ã«ã‚«ã‚¿ã‚«ãƒŠã¸ï¼ˆåŠ©è©ã®èª¤èª­é˜²æ­¢ï¼‰
  function hiraToKata(str){
    return str.replace(/[ã-ã‚“]/g, ch => String.fromCharCode(ch.charCodeAt(0) + 0x60));
  }

  function speak(text){
    // Web Speech API
    const u = new SpeechSynthesisUtterance();
    u.lang = 'ja-JP';
    u.rate = 1; u.pitch = 1; u.volume = 1;
    u.text = hiraToKata(text); // ã‚«ã‚¿ã‚«ãƒŠåŒ–ã§åŠ©è©åŒ–ã‚’å›é¿
    window.speechSynthesis.cancel();
    window.speechSynthesis.speak(u);
  }

  function render(){
    digitsEl.textContent = String(currentNumber).padStart(currentDigits,'0');
    digitsEl.className = 'digits ' + (hidden? 'hidden':'visible');
  }

  function showNew(){
    currentNumber = randNDigits(currentDigits);
    render();
    if(autoSpeak.checked){ speak(numberToReading(currentNumber)); }
  }

  // åˆæœŸè¡¨ç¤º
  showNew();

  // Buttons
  nextBtn.addEventListener('click', showNew);
  speakBtn.addEventListener('click', () => speak(numberToReading(currentNumber)));
  toggleBtn.addEventListener('click', () => { hidden = !hidden; render(); });
  resetBtn.addEventListener('click', () => { hidden=false; showNew(); });

  // Auto mode
  autoStart.addEventListener('click', () => {
    const sec = Math.max(1, Number(intervalSec.value||2));
    clearInterval(timer); timer = setInterval(showNew, sec*1000);
    autoStart.classList.add('ok'); setTimeout(()=>autoStart.classList.remove('ok'),600);
  });
  autoStop.addEventListener('click', () => { clearInterval(timer); timer=null; autoStop.classList.add('warn'); setTimeout(()=>autoStop.classList.remove('warn'),600); });

  // Keyboard shortcuts
  window.addEventListener('keydown', (e) => {
    if(e.key === ' '){ e.preventDefault(); showNew(); }
    else if(e.key.toLowerCase() === 'h'){ hidden = !hidden; render(); }
    else if(e.key.toLowerCase() === 'f'){
      if(!document.fullscreenElement) document.documentElement.requestFullscreen().catch(()=>{});
      else document.exitFullscreen();
    } else if(e.key.toLowerCase() === 'r'){ hidden=false; showNew(); }
  });
})();
</script>
</body>
</html>
